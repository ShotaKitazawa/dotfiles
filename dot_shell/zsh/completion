#!/usr/bin/env zsh

rows=(
  #"COMMAND,OPTS"
  "kubectl,completion zsh"
  "pip,completion --zsh"
  "helm,completion zsh"
  "chezmoi,completion zsh"
  "gh,completion -s zsh"
  "mise,completion zsh"
  "fzf,--zsh"
)

for r in "${rows[@]}"; do
  IFS=',' read -r COMMAND OPTS <<< "$r"
  FILE=$HOME/.completions/_$COMMAND
  command -v $COMMAND >/dev/null && [[ ! -f $FILE || ! -s $FILE ]] && ( eval $COMMAND $OPTS > $FILE )
done

# load completion files by fpath
fpath=(
"$HOME/.completions"
"${fpath[@]}"
)
autoload -Uz compinit && compinit
