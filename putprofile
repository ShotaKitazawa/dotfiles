#!/usr/bin/env sh
# Auther: Kitazawa

# !! DOTFILE OVERWRITE !!

path=$(cd $(dirname $0) && pwd)

deploylink(){
  if [ -L ~/$1 ]; then
    echo "$1 has already deployed to ~/"
    return 0
  elif [ -e ~/$1 ]; then
    rm ~/$1 -rf
  fi
  ln -s $path/$1 ~/$1
  echo "$1 was deployed to ~/"
}


if [ "$(uname)" = 'Darwin' ]; then deploylink .inputrc; fi
deploylink .gitconfig
deploylink .gitignore
deploylink .tmux.conf
deploylink .vim
deploylink .bashrc_self
deploylink .gdbinit
deploylink .config
deploylink .vrapperrc

# let .bashrc read .bashrc_self

grep .bashrc_self ~/.bashrc > /dev/null 2>&1
if [ $? != 0 ]; then
  echo "if [ -f ~/.bashrc_self ]; then source ~/.bashrc_self; fi" >> ~/.bashrc
fi

# vim-undofile folder
if [ ! -d ~/.vimundo ]; then
  mkdir ~/.vimundo
  echo "mkdir ~/.vimundo"
fi

# download peda (gdb extention)
if [ ! -d ~/.peda ]; then
  git clone https://github.com/longld/peda ~/.peda > /dev/null 2>&1
  echo "downloaded peda"
fi

# install Powerline fonts for lightline.vim
cd ~
git clone https://github.com/powerline/fonts.git > /dev/null 2>&1
if [ $? = 0 ]; then
  cd fonts
  ./install.sh > /dev/null
  cd ..
  rm -rf fonts
  echo "install Powerline fonts"
else
  echo "error: failed to download Powerline fonts"
fi
